# Ticket-system
Работа с тикетами через Telegram


Вы можете настроить интеграцию с Telegram, чтобы клиенты могли обращаться с запросами к поддержке через созданного вами бота.
Настройка со стороны Telegram

Создайте бота в Telegram. Для этого:
Перейдите по ссылке https://t.me/BotFather или найдите в поиске Telegram — BotFather.
[IMG]
Запустите бота при помощи команды /start.
Создайте своего бота командой /newbot. Придумайте название для бота и его пользователя.
[IMG]
Сохраните имя бота и токен из последнего сообщения.
Настройка со стороны BILLmanager

Со стороны провайдера

Чтобы установить модуль, перейдите в Интеграция → Модули → выберите Telegram → кнопка Установить.
Чтобы настроить модуль, перейдите в Поддержка → Telegram → кнопка Создать:
Выберите Провайдера.
Укажите Имя бота в Telegram.
Укажите Токен бота.
Введите в поле Ссылка для Webhook адрес вида https://URL_BILLmanager/mancgi/telegram_support_webhook . Telegram будет посылать на этот адрес вебхуки о том, что клиент и бот связаны. Вы можете оставить поле пустым. В этом случае будет использоваться адрес сервера с BILLmanager.
Нажмите Ok.
Добавленные Telegram-боты и их состояние отображаются в таблице.
Вы можете выполнить следующие действия с ботами:
изменить;
удалить;
включить или выключить.
[IMG]
Со стороны клиента

Для работы с Telegram клиент указывает в Настройках пользователя логин своего аккаунта в Telegram (без @). Подробнее см. в статье Уведомления.
В настройках отображаются включённые боты для получения уведомлений и работы с поддержкой.
[IMG]
Работа с тикетами

Для работы с ботом используются команды (аргумент передается через _, /command_value, например /ticket_159):
/start — список тикетов пользователя с возможностью выбрать тикет;
[IMG]
/ticket_{номер тикета} — информация о тикете, включая последнее сообщение с прикреплёнными файлами. Доступен выбор действий:
Добавить ответ. Максимальная длина сообщения 255 символов и не более 5 файлов;
Поместить в архив. Кнопка появляется для тикетов в статусе "Ожидает ответа от клиента".
[IMG]
/createticket — создание нового тикета. При создании нового тикета:
Клиент выбирает провайдера, если в биллинге их несколько и клиент пользуется услугами от разных провайдеров.
Клиент выбирает отдел, куда будет направлен запрос.
Система проверяет не настроена ли на них платная поддержка по предоплаченным обращениям. Если настроена, то проверяет есть ли у клиента предоплаченные обращения. Если нет, то выводит сообщение о невозможности создать обращение.
Клиент выбирает услугу, по которой возникла проблема.
Клиент пишет тему запроса.
Клиент пишет сообщение о своей проблеме. Клиент может прикрепить до 5 файлов.[IMG]
